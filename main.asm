; Listing generated by Microsoft (R) Optimizing Compiler Version 19.44.35216.0 

include listing.inc

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	__local_stdio_printf_options
PUBLIC	_vfprintf_l
PUBLIC	printf
PUBLIC	main
EXTRN	__report_rangecheckfailure:PROC
EXTRN	__acrt_iob_func:PROC
EXTRN	fgets:PROC
EXTRN	__stdio_common_vfprintf:PROC
EXTRN	atof:PROC
EXTRN	atoi:PROC
EXTRN	strcmp:PROC
EXTRN	strcspn:PROC
EXTRN	strlen:PROC
EXTRN	strtok:PROC
EXTRN	load_bmp:PROC
EXTRN	free_bmp:PROC
EXTRN	fill_bmp:PROC
EXTRN	save_bmp:PROC
EXTRN	rotate_bmp:PROC
EXTRN	scale_bmp:PROC
EXTRN	embed_message:PROC
EXTRN	extract_message:PROC
EXTRN	free_message:PROC
EXTRN	resize_bmp:PROC
EXTRN	crop_bmp:PROC
EXTRN	__GSHandlerCheck:PROC
EXTRN	__security_check_cookie:PROC
EXTRN	__security_cookie:QWORD
EXTRN	_fltused:DWORD
_DATA	SEGMENT
COMM	?_OptionsStorage@?1??__local_stdio_printf_options@@9@9:QWORD							; `__local_stdio_printf_options'::`2'::_OptionsStorage
_DATA	ENDS
_BSS	SEGMENT
$SG11850 DB	01H DUP (?)
_BSS	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$_vfprintf_l DD imagerel $LN3
	DD	imagerel $LN3+67
	DD	imagerel $unwind$_vfprintf_l
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$printf DD imagerel $LN3
	DD	imagerel $LN3+87
	DD	imagerel $unwind$printf
pdata	ENDS
pdata	SEGMENT
$pdata$print_menu DD imagerel print_menu
	DD	imagerel print_menu+166
	DD	imagerel $unwind$print_menu
$pdata$main DD	imagerel $LN87
	DD	imagerel $LN87+2486
	DD	imagerel $unwind$main
pdata	ENDS
_DATA	SEGMENT
$SG11674 DB	0aH, '=== Image Utility ===', 0aH, 00H
$SG11675 DB	'Commands:', 0aH, 00H
	ORG $+5
$SG11676 DB	'  load <filename>         - Load a BMP file', 0aH, 00H
	ORG $+3
$SG11677 DB	'  save <filename>         - Save current image', 0aH, 00H
$SG11678 DB	'  fill <R> <G> <B>        - Fill image with color', 0aH, 00H
	ORG $+5
$SG11679 DB	'  rotate <angle>          - Rotate by angle (degrees)', 0aH
	DB	00H
	ORG $+1
$SG11680 DB	'  scale <factor>          - Scale by factor (e.g. 0.5, 2'
	DB	'.0)', 0aH, 00H
	ORG $+3
$SG11681 DB	'  resize <w> <h>          - Resize to width/height', 0aH
	DB	00H
	ORG $+4
$SG11682 DB	'  crop <x> <y> <w> <h>    - Crop region', 0aH, 00H
	ORG $+7
$SG11683 DB	'  embed <message>         - Hide text inside image', 0aH
	DB	00H
	ORG $+4
$SG11684 DB	'  extract                 - Recover hidden text from ima'
	DB	'ge', 0aH, 00H
	ORG $+4
$SG11685 DB	'  exit                    - Quit program', 0aH, 00H
	ORG $+6
$SG11686 DB	'======================', 0aH, 00H
$SG11742 DB	'Welcome to the Image Utility (BMP only).', 0aH, 00H
	ORG $+2
$SG11743 DB	0aH, '> ', 00H
$SG11745 DB	0dH, 0aH, 00H
	ORG $+1
$SG11747 DB	' ', 00H
	ORG $+2
$SG11751 DB	'exit', 00H
	ORG $+3
$SG11754 DB	'help', 00H
	ORG $+3
$SG11757 DB	'load', 00H
	ORG $+3
$SG11758 DB	' ', 00H
	ORG $+6
$SG11760 DB	'Usage: load <filename>', 0aH, 00H
$SG11763 DB	'Failed to load %s', 0aH, 00H
	ORG $+5
$SG11764 DB	'Loaded %s (%dx%d, %d bpp)', 0aH, 00H
	ORG $+1
$SG11767 DB	'save', 00H
	ORG $+7
$SG11769 DB	'No image loaded.', 0aH, 00H
	ORG $+2
$SG11770 DB	' ', 00H
	ORG $+2
$SG11772 DB	'Usage: save <filename>', 0aH, 00H
$SG11775 DB	'Saved image to %s', 0aH, 00H
	ORG $+5
$SG11776 DB	'Failed to save image.', 0aH, 00H
	ORG $+1
$SG11779 DB	'fill', 00H
	ORG $+3
$SG11781 DB	'No image loaded.', 0aH, 00H
	ORG $+2
$SG11782 DB	' ', 00H
	ORG $+2
$SG11783 DB	' ', 00H
	ORG $+2
$SG11784 DB	' ', 00H
	ORG $+2
$SG11787 DB	'Usage: fill <R> <G> <B>', 0aH, 00H
	ORG $+7
$SG11788 DB	'Image filled with color (%d, %d, %d).', 0aH, 00H
	ORG $+1
$SG11791 DB	'rotate', 00H
	ORG $+1
$SG11793 DB	'No image loaded.', 0aH, 00H
	ORG $+2
$SG11794 DB	' ', 00H
	ORG $+2
$SG11796 DB	'Usage: rotate <angle>', 0aH, 00H
	ORG $+1
$SG11799 DB	'Rotated image by %.2f degrees.', 0aH, 00H
$SG11800 DB	'Rotation failed.', 0aH, 00H
	ORG $+2
$SG11803 DB	'scale', 00H
	ORG $+6
$SG11805 DB	'No image loaded.', 0aH, 00H
	ORG $+2
$SG11806 DB	' ', 00H
	ORG $+2
$SG11808 DB	'Usage: scale <factor>', 0aH, 00H
	ORG $+1
$SG11810 DB	'Scale factor must be > 0.', 0aH, 00H
	ORG $+5
$SG11813 DB	'Scaled image by %.2fx.', 0aH, 00H
$SG11814 DB	'Scaling failed.', 0aH, 00H
	ORG $+3
$SG11817 DB	'resize', 00H
	ORG $+5
$SG11819 DB	'No image loaded.', 0aH, 00H
	ORG $+2
$SG11820 DB	' ', 00H
	ORG $+2
$SG11821 DB	' ', 00H
	ORG $+6
$SG11824 DB	'Usage: resize <w> <h>', 0aH, 00H
	ORG $+1
$SG11827 DB	'Resized image to %dx%d.', 0aH, 00H
	ORG $+7
$SG11828 DB	'Resize failed.', 0aH, 00H
$SG11831 DB	'crop', 00H
	ORG $+3
$SG11833 DB	'No image loaded.', 0aH, 00H
	ORG $+2
$SG11834 DB	' ', 00H
	ORG $+2
$SG11835 DB	' ', 00H
	ORG $+2
$SG11836 DB	' ', 00H
	ORG $+2
$SG11837 DB	' ', 00H
	ORG $+6
$SG11840 DB	'Usage: crop <x> <y> <w> <h>', 0aH, 00H
	ORG $+3
$SG11843 DB	'Cropped to region (%d,%d,%d,%d).', 0aH, 00H
	ORG $+6
$SG11844 DB	'Crop failed.', 0aH, 00H
	ORG $+2
$SG11847 DB	'embed', 00H
	ORG $+2
$SG11849 DB	'No image loaded.', 0aH, 00H
	ORG $+6
$SG11852 DB	'Usage: embed <message>', 0aH, 00H
$SG11855 DB	'Message embedded.', 0aH, 00H
	ORG $+5
$SG11856 DB	'Failed to embed message.', 0aH, 00H
	ORG $+6
$SG11859 DB	'extract', 00H
$SG11861 DB	'No image loaded.', 0aH, 00H
	ORG $+6
$SG11864 DB	'Extracted message: "%s"', 0aH, 00H
	ORG $+7
$SG11865 DB	'No message found.', 0aH, 00H
	ORG $+5
$SG11866 DB	'Unknown command: %s', 0aH, 00H
	ORG $+3
$SG11867 DB	'Goodbye!', 0aH, 00H
_DATA	ENDS
voltbl	SEGMENT
_volmd	DD	0ffffffffH
	DDSymXIndex: 	FLAT:main
	DD	011H
	DD	099eH
voltbl	ENDS
xdata	SEGMENT
$unwind$print_menu DD 010401H
	DD	04204H
$unwind$main DD	021919H
	DD	0670107H
	DD	imagerel __GSHandlerCheck
	DD	0320H
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$printf DD 011801H
	DD	06218H
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$_vfprintf_l DD 011801H
	DD	06218H
xdata	ENDS
; Function compile flags: /Odsp
_TEXT	SEGMENT
img$ = 48
color$1 = 56
cmd$2 = 64
new_h$3 = 72
new_w$4 = 76
h$5 = 80
w$6 = 84
y$7 = 88
x$8 = 92
fname$9 = 96
fname$10 = 104
factor$11 = 112
msg$12 = 120
$T13 = 128
tmp$14 = 136
r$15 = 144
g$16 = 152
b$17 = 160
ang$18 = 168
rot$19 = 176
angle$20 = 184
fac$21 = 192
sc$22 = 200
w$23 = 208
h$24 = 216
rsz$25 = 224
sx$26 = 232
sy$27 = 240
sw$28 = 248
sh$29 = 256
cr$30 = 264
msg$31 = 272
line$ = 288
__$ArrayPad$ = 800
main	PROC
; File C:\Software Analysis & Debugging\hw01\src\main.c
; Line 25
$LN87:
	sub	rsp, 824				; 00000338H
	mov	rax, QWORD PTR __security_cookie
	xor	rax, rsp
	mov	QWORD PTR __$ArrayPad$[rsp], rax
; Line 27
	mov	QWORD PTR img$[rsp], 0
; Line 31
	lea	rcx, OFFSET FLAT:$SG11742
	call	printf
; Line 32
	call	print_menu
	npad	1
$LN86@main:
$LN85@main:
$LN84@main:
$LN83@main:
$LN82@main:
$LN81@main:
$LN80@main:
$LN79@main:
$LN78@main:
$LN77@main:
$LN76@main:
$LN75@main:
$LN74@main:
$LN73@main:
$LN72@main:
$LN71@main:
$LN70@main:
$LN69@main:
$LN68@main:
$LN2@main:
; Line 35
	xor	eax, eax
	cmp	eax, 1
	je	$LN3@main
; Line 38
	lea	rcx, OFFSET FLAT:$SG11743
	call	printf
; Line 39
	xor	ecx, ecx
	call	__acrt_iob_func
	mov	r8, rax
	mov	edx, 512				; 00000200H
	lea	rcx, QWORD PTR line$[rsp]
	call	fgets
	test	rax, rax
	jne	SHORT $LN4@main
; Line 40
	jmp	$LN3@main
$LN4@main:
; Line 43
	lea	rdx, OFFSET FLAT:$SG11745
	lea	rcx, QWORD PTR line$[rsp]
	call	strcspn
	mov	QWORD PTR $T13[rsp], rax
	cmp	QWORD PTR $T13[rsp], 512		; 00000200H
	jae	SHORT $LN66@main
	jmp	SHORT $LN67@main
$LN66@main:
	call	__report_rangecheckfailure
	npad	1
$LN67@main:
	mov	rax, QWORD PTR $T13[rsp]
	mov	BYTE PTR line$[rsp+rax], 0
; Line 46
	lea	rcx, QWORD PTR line$[rsp]
	call	strlen
	test	rax, rax
	jne	SHORT $LN5@main
; Line 47
	jmp	$LN2@main
$LN5@main:
; Line 50
	lea	rdx, OFFSET FLAT:$SG11747
	lea	rcx, QWORD PTR line$[rsp]
	call	strtok
	mov	QWORD PTR cmd$2[rsp], rax
; Line 51
	cmp	QWORD PTR cmd$2[rsp], 0
	jne	SHORT $LN6@main
; Line 52
	jmp	$LN68@main
$LN6@main:
; Line 55
	lea	rdx, OFFSET FLAT:$SG11751
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	SHORT $LN7@main
; Line 57
	jmp	$LN3@main
; Line 58
	jmp	$LN8@main
$LN7@main:
; Line 61
	lea	rdx, OFFSET FLAT:$SG11754
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	SHORT $LN9@main
; Line 63
	call	print_menu
	npad	1
; Line 64
	jmp	$LN10@main
$LN9@main:
; Line 67
	lea	rdx, OFFSET FLAT:$SG11757
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	$LN11@main
; Line 70
	lea	rdx, OFFSET FLAT:$SG11758
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR fname$9[rsp], rax
; Line 71
	cmp	QWORD PTR fname$9[rsp], 0
	jne	SHORT $LN13@main
; Line 73
	lea	rcx, OFFSET FLAT:$SG11760
	call	printf
	npad	1
; Line 74
	jmp	$LN69@main
$LN13@main:
; Line 78
	mov	rcx, QWORD PTR fname$9[rsp]
	call	load_bmp
	mov	QWORD PTR tmp$14[rsp], rax
; Line 80
	cmp	QWORD PTR tmp$14[rsp], 0
	jne	SHORT $LN14@main
; Line 82
	mov	rdx, QWORD PTR fname$9[rsp]
	lea	rcx, OFFSET FLAT:$SG11763
	call	printf
	npad	1
; Line 83
	jmp	SHORT $LN15@main
$LN14@main:
; Line 88
	mov	rcx, QWORD PTR img$[rsp]
	call	free_bmp
; Line 91
	mov	rax, QWORD PTR tmp$14[rsp]
	mov	QWORD PTR img$[rsp], rax
; Line 94
	mov	rax, QWORD PTR img$[rsp]
	movzx	eax, WORD PTR [rax+28]
	mov	DWORD PTR [rsp+32], eax
	mov	rax, QWORD PTR img$[rsp]
	mov	r9d, DWORD PTR [rax+22]
	mov	rax, QWORD PTR img$[rsp]
	mov	r8d, DWORD PTR [rax+18]
	mov	rdx, QWORD PTR fname$9[rsp]
	lea	rcx, OFFSET FLAT:$SG11764
	call	printf
	npad	1
$LN15@main:
; Line 97
	jmp	$LN12@main
$LN11@main:
; Line 100
	lea	rdx, OFFSET FLAT:$SG11767
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	$LN16@main
; Line 102
	cmp	QWORD PTR img$[rsp], 0
	jne	SHORT $LN18@main
; Line 104
	lea	rcx, OFFSET FLAT:$SG11769
	call	printf
	npad	1
; Line 105
	jmp	$LN70@main
$LN18@main:
; Line 107
	lea	rdx, OFFSET FLAT:$SG11770
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR fname$10[rsp], rax
; Line 108
	cmp	QWORD PTR fname$10[rsp], 0
	jne	SHORT $LN19@main
; Line 110
	lea	rcx, OFFSET FLAT:$SG11772
	call	printf
	npad	1
; Line 111
	jmp	$LN71@main
$LN19@main:
; Line 113
	mov	rdx, QWORD PTR img$[rsp]
	mov	rcx, QWORD PTR fname$10[rsp]
	call	save_bmp
	test	eax, eax
	jne	SHORT $LN20@main
; Line 115
	mov	rdx, QWORD PTR fname$10[rsp]
	lea	rcx, OFFSET FLAT:$SG11775
	call	printf
	npad	1
; Line 116
	jmp	SHORT $LN21@main
$LN20@main:
; Line 119
	lea	rcx, OFFSET FLAT:$SG11776
	call	printf
	npad	1
$LN21@main:
; Line 121
	jmp	$LN17@main
$LN16@main:
; Line 124
	lea	rdx, OFFSET FLAT:$SG11779
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	$LN22@main
; Line 126
	cmp	QWORD PTR img$[rsp], 0
	jne	SHORT $LN24@main
; Line 128
	lea	rcx, OFFSET FLAT:$SG11781
	call	printf
	npad	1
; Line 129
	jmp	$LN72@main
$LN24@main:
; Line 131
	lea	rdx, OFFSET FLAT:$SG11782
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR r$15[rsp], rax
; Line 132
	lea	rdx, OFFSET FLAT:$SG11783
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR g$16[rsp], rax
; Line 133
	lea	rdx, OFFSET FLAT:$SG11784
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR b$17[rsp], rax
; Line 134
	cmp	QWORD PTR r$15[rsp], 0
	je	SHORT $LN26@main
	cmp	QWORD PTR g$16[rsp], 0
	je	SHORT $LN26@main
	cmp	QWORD PTR b$17[rsp], 0
	jne	SHORT $LN25@main
$LN26@main:
; Line 136
	lea	rcx, OFFSET FLAT:$SG11787
	call	printf
	npad	1
; Line 137
	jmp	$LN73@main
$LN25@main:
; Line 140
	mov	rcx, QWORD PTR r$15[rsp]
	call	atoi
	mov	ecx, 1
	imul	rcx, rcx, 0
	mov	BYTE PTR color$1[rsp+rcx], al
; Line 141
	mov	rcx, QWORD PTR g$16[rsp]
	call	atoi
	mov	ecx, 1
	imul	rcx, rcx, 1
	mov	BYTE PTR color$1[rsp+rcx], al
; Line 142
	mov	rcx, QWORD PTR b$17[rsp]
	call	atoi
	mov	ecx, 1
	imul	rcx, rcx, 2
	mov	BYTE PTR color$1[rsp+rcx], al
; Line 143
	lea	rdx, QWORD PTR color$1[rsp]
	mov	rcx, QWORD PTR img$[rsp]
	call	fill_bmp
; Line 144
	mov	eax, 1
	imul	rax, rax, 2
	movzx	eax, BYTE PTR color$1[rsp+rax]
	mov	ecx, 1
	imul	rcx, rcx, 1
	movzx	ecx, BYTE PTR color$1[rsp+rcx]
	mov	edx, 1
	imul	rdx, rdx, 0
	movzx	edx, BYTE PTR color$1[rsp+rdx]
	mov	r9d, eax
	mov	r8d, ecx
	lea	rcx, OFFSET FLAT:$SG11788
	call	printf
	npad	1
; Line 145
	jmp	$LN23@main
$LN22@main:
; Line 148
	lea	rdx, OFFSET FLAT:$SG11791
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	$LN27@main
; Line 150
	cmp	QWORD PTR img$[rsp], 0
	jne	SHORT $LN29@main
; Line 152
	lea	rcx, OFFSET FLAT:$SG11793
	call	printf
	npad	1
; Line 153
	jmp	$LN74@main
$LN29@main:
; Line 155
	lea	rdx, OFFSET FLAT:$SG11794
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR ang$18[rsp], rax
; Line 156
	cmp	QWORD PTR ang$18[rsp], 0
	jne	SHORT $LN30@main
; Line 158
	lea	rcx, OFFSET FLAT:$SG11796
	call	printf
	npad	1
; Line 159
	jmp	$LN75@main
$LN30@main:
; Line 161
	mov	rcx, QWORD PTR ang$18[rsp]
	call	atof
	movsd	QWORD PTR angle$20[rsp], xmm0
; Line 162
	movsd	xmm1, QWORD PTR angle$20[rsp]
	mov	rcx, QWORD PTR img$[rsp]
	call	rotate_bmp
	mov	QWORD PTR rot$19[rsp], rax
; Line 163
	cmp	QWORD PTR rot$19[rsp], 0
	je	SHORT $LN31@main
; Line 165
	mov	rcx, QWORD PTR img$[rsp]
	call	free_bmp
; Line 166
	mov	rax, QWORD PTR rot$19[rsp]
	mov	QWORD PTR img$[rsp], rax
; Line 167
	movsd	xmm1, QWORD PTR angle$20[rsp]
	movq	rdx, xmm1
	lea	rcx, OFFSET FLAT:$SG11799
	call	printf
	npad	1
; Line 168
	jmp	SHORT $LN32@main
$LN31@main:
; Line 171
	lea	rcx, OFFSET FLAT:$SG11800
	call	printf
	npad	1
$LN32@main:
; Line 173
	jmp	$LN28@main
$LN27@main:
; Line 176
	lea	rdx, OFFSET FLAT:$SG11803
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	$LN33@main
; Line 178
	cmp	QWORD PTR img$[rsp], 0
	jne	SHORT $LN35@main
; Line 180
	lea	rcx, OFFSET FLAT:$SG11805
	call	printf
	npad	1
; Line 181
	jmp	$LN76@main
$LN35@main:
; Line 183
	lea	rdx, OFFSET FLAT:$SG11806
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR fac$21[rsp], rax
; Line 184
	cmp	QWORD PTR fac$21[rsp], 0
	jne	SHORT $LN36@main
; Line 186
	lea	rcx, OFFSET FLAT:$SG11808
	call	printf
	npad	1
; Line 187
	jmp	$LN77@main
$LN36@main:
; Line 189
	mov	rcx, QWORD PTR fac$21[rsp]
	call	atof
	movsd	QWORD PTR factor$11[rsp], xmm0
; Line 190
	xorps	xmm0, xmm0
	comisd	xmm0, QWORD PTR factor$11[rsp]
	jb	SHORT $LN37@main
; Line 192
	lea	rcx, OFFSET FLAT:$SG11810
	call	printf
	npad	1
; Line 193
	jmp	$LN78@main
$LN37@main:
; Line 195
	movsd	xmm1, QWORD PTR factor$11[rsp]
	mov	rcx, QWORD PTR img$[rsp]
	call	scale_bmp
	mov	QWORD PTR sc$22[rsp], rax
; Line 196
	cmp	QWORD PTR sc$22[rsp], 0
	je	SHORT $LN38@main
; Line 198
	mov	rcx, QWORD PTR img$[rsp]
	call	free_bmp
; Line 199
	mov	rax, QWORD PTR sc$22[rsp]
	mov	QWORD PTR img$[rsp], rax
; Line 200
	movsd	xmm1, QWORD PTR factor$11[rsp]
	movq	rdx, xmm1
	lea	rcx, OFFSET FLAT:$SG11813
	call	printf
	npad	1
; Line 201
	jmp	SHORT $LN39@main
$LN38@main:
; Line 204
	lea	rcx, OFFSET FLAT:$SG11814
	call	printf
	npad	1
$LN39@main:
; Line 206
	jmp	$LN34@main
$LN33@main:
; Line 207
	lea	rdx, OFFSET FLAT:$SG11817
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	$LN40@main
; Line 209
	cmp	QWORD PTR img$[rsp], 0
	jne	SHORT $LN42@main
; Line 211
	lea	rcx, OFFSET FLAT:$SG11819
	call	printf
	npad	1
; Line 212
	jmp	$LN79@main
$LN42@main:
; Line 214
	lea	rdx, OFFSET FLAT:$SG11820
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR w$23[rsp], rax
; Line 215
	lea	rdx, OFFSET FLAT:$SG11821
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR h$24[rsp], rax
; Line 216
	cmp	QWORD PTR w$23[rsp], 0
	je	SHORT $LN44@main
	cmp	QWORD PTR h$24[rsp], 0
	jne	SHORT $LN43@main
$LN44@main:
; Line 218
	lea	rcx, OFFSET FLAT:$SG11824
	call	printf
	npad	1
; Line 219
	jmp	$LN80@main
$LN43@main:
; Line 221
	mov	rcx, QWORD PTR w$23[rsp]
	call	atoi
	mov	DWORD PTR new_w$4[rsp], eax
	mov	rcx, QWORD PTR h$24[rsp]
	call	atoi
	mov	DWORD PTR new_h$3[rsp], eax
; Line 222
	mov	r8d, DWORD PTR new_h$3[rsp]
	mov	edx, DWORD PTR new_w$4[rsp]
	mov	rcx, QWORD PTR img$[rsp]
	call	resize_bmp
	mov	QWORD PTR rsz$25[rsp], rax
; Line 223
	cmp	QWORD PTR rsz$25[rsp], 0
	je	SHORT $LN45@main
; Line 225
	mov	rcx, QWORD PTR img$[rsp]
	call	free_bmp
; Line 226
	mov	rax, QWORD PTR rsz$25[rsp]
	mov	QWORD PTR img$[rsp], rax
; Line 227
	mov	r8d, DWORD PTR new_h$3[rsp]
	mov	edx, DWORD PTR new_w$4[rsp]
	lea	rcx, OFFSET FLAT:$SG11827
	call	printf
	npad	1
; Line 228
	jmp	SHORT $LN46@main
$LN45@main:
; Line 231
	lea	rcx, OFFSET FLAT:$SG11828
	call	printf
	npad	1
$LN46@main:
; Line 233
	jmp	$LN41@main
$LN40@main:
; Line 234
	lea	rdx, OFFSET FLAT:$SG11831
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	$LN47@main
; Line 236
	cmp	QWORD PTR img$[rsp], 0
	jne	SHORT $LN49@main
; Line 238
	lea	rcx, OFFSET FLAT:$SG11833
	call	printf
	npad	1
; Line 239
	jmp	$LN81@main
$LN49@main:
; Line 241
	lea	rdx, OFFSET FLAT:$SG11834
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR sx$26[rsp], rax
; Line 242
	lea	rdx, OFFSET FLAT:$SG11835
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR sy$27[rsp], rax
; Line 243
	lea	rdx, OFFSET FLAT:$SG11836
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR sw$28[rsp], rax
; Line 244
	lea	rdx, OFFSET FLAT:$SG11837
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR sh$29[rsp], rax
; Line 245
	cmp	QWORD PTR sx$26[rsp], 0
	je	SHORT $LN51@main
	cmp	QWORD PTR sy$27[rsp], 0
	je	SHORT $LN51@main
	cmp	QWORD PTR sw$28[rsp], 0
	je	SHORT $LN51@main
	cmp	QWORD PTR sh$29[rsp], 0
	jne	SHORT $LN50@main
$LN51@main:
; Line 247
	lea	rcx, OFFSET FLAT:$SG11840
	call	printf
	npad	1
; Line 248
	jmp	$LN82@main
$LN50@main:
; Line 250
	mov	rcx, QWORD PTR sx$26[rsp]
	call	atoi
	mov	DWORD PTR x$8[rsp], eax
	mov	rcx, QWORD PTR sy$27[rsp]
	call	atoi
	mov	DWORD PTR y$7[rsp], eax
	mov	rcx, QWORD PTR sw$28[rsp]
	call	atoi
	mov	DWORD PTR w$6[rsp], eax
	mov	rcx, QWORD PTR sh$29[rsp]
	call	atoi
	mov	DWORD PTR h$5[rsp], eax
; Line 251
	mov	eax, DWORD PTR h$5[rsp]
	mov	DWORD PTR [rsp+32], eax
	mov	r9d, DWORD PTR w$6[rsp]
	mov	r8d, DWORD PTR y$7[rsp]
	mov	edx, DWORD PTR x$8[rsp]
	mov	rcx, QWORD PTR img$[rsp]
	call	crop_bmp
	mov	QWORD PTR cr$30[rsp], rax
; Line 252
	cmp	QWORD PTR cr$30[rsp], 0
	je	SHORT $LN52@main
; Line 254
	mov	rcx, QWORD PTR img$[rsp]
	call	free_bmp
; Line 255
	mov	rax, QWORD PTR cr$30[rsp]
	mov	QWORD PTR img$[rsp], rax
; Line 256
	mov	eax, DWORD PTR h$5[rsp]
	mov	DWORD PTR [rsp+32], eax
	mov	r9d, DWORD PTR w$6[rsp]
	mov	r8d, DWORD PTR y$7[rsp]
	mov	edx, DWORD PTR x$8[rsp]
	lea	rcx, OFFSET FLAT:$SG11843
	call	printf
	npad	1
; Line 257
	jmp	SHORT $LN53@main
$LN52@main:
; Line 260
	lea	rcx, OFFSET FLAT:$SG11844
	call	printf
	npad	1
$LN53@main:
; Line 262
	jmp	$LN48@main
$LN47@main:
; Line 263
	lea	rdx, OFFSET FLAT:$SG11847
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	$LN54@main
; Line 265
	cmp	QWORD PTR img$[rsp], 0
	jne	SHORT $LN56@main
; Line 267
	lea	rcx, OFFSET FLAT:$SG11849
	call	printf
	npad	1
; Line 268
	jmp	$LN83@main
$LN56@main:
; Line 270
	lea	rdx, OFFSET FLAT:$SG11850
	xor	ecx, ecx
	call	strtok
	mov	QWORD PTR msg$31[rsp], rax
; Line 271
	cmp	QWORD PTR msg$31[rsp], 0
	jne	SHORT $LN57@main
; Line 273
	lea	rcx, OFFSET FLAT:$SG11852
	call	printf
	npad	1
; Line 274
	jmp	$LN84@main
$LN57@main:
; Line 276
	xor	r8d, r8d
	mov	rdx, QWORD PTR msg$31[rsp]
	mov	rcx, QWORD PTR img$[rsp]
	call	embed_message
	test	eax, eax
	jne	SHORT $LN58@main
; Line 278
	lea	rcx, OFFSET FLAT:$SG11855
	call	printf
	npad	1
; Line 279
	jmp	SHORT $LN59@main
$LN58@main:
; Line 282
	lea	rcx, OFFSET FLAT:$SG11856
	call	printf
	npad	1
$LN59@main:
; Line 284
	jmp	$LN55@main
$LN54@main:
; Line 285
	lea	rdx, OFFSET FLAT:$SG11859
	mov	rcx, QWORD PTR cmd$2[rsp]
	call	strcmp
	test	eax, eax
	jne	SHORT $LN60@main
; Line 287
	cmp	QWORD PTR img$[rsp], 0
	jne	SHORT $LN62@main
; Line 289
	lea	rcx, OFFSET FLAT:$SG11861
	call	printf
	npad	1
; Line 290
	jmp	$LN85@main
$LN62@main:
; Line 292
	xor	edx, edx
	mov	rcx, QWORD PTR img$[rsp]
	call	extract_message
	mov	QWORD PTR msg$12[rsp], rax
; Line 293
	cmp	QWORD PTR msg$12[rsp], 0
	je	SHORT $LN63@main
; Line 295
	mov	rdx, QWORD PTR msg$12[rsp]
	lea	rcx, OFFSET FLAT:$SG11864
	call	printf
; Line 296
	mov	rcx, QWORD PTR msg$12[rsp]
	call	free_message
	npad	1
; Line 297
	jmp	SHORT $LN64@main
$LN63@main:
; Line 300
	lea	rcx, OFFSET FLAT:$SG11865
	call	printf
	npad	1
$LN64@main:
; Line 302
	jmp	SHORT $LN61@main
$LN60@main:
; Line 305
	mov	rdx, QWORD PTR cmd$2[rsp]
	lea	rcx, OFFSET FLAT:$SG11866
	call	printf
; Line 306
	call	print_menu
	npad	1
$LN61@main:
$LN55@main:
$LN48@main:
$LN41@main:
$LN34@main:
$LN28@main:
$LN23@main:
$LN17@main:
$LN12@main:
$LN10@main:
$LN8@main:
; Line 308
	jmp	$LN86@main
$LN3@main:
; Line 310
	mov	rcx, QWORD PTR img$[rsp]
	call	free_bmp
; Line 311
	lea	rcx, OFFSET FLAT:$SG11867
	call	printf
; Line 312
	xor	eax, eax
$LN65@main:
; Line 313
	mov	rcx, QWORD PTR __$ArrayPad$[rsp]
	xor	rcx, rsp
	call	__security_check_cookie
	add	rsp, 824				; 00000338H
	ret	0
main	ENDP
_TEXT	ENDS
; Function compile flags: /Odsp
_TEXT	SEGMENT
print_menu PROC
; File C:\Software Analysis & Debugging\hw01\src\main.c
; Line 8
	sub	rsp, 40					; 00000028H
; Line 9
	lea	rcx, OFFSET FLAT:$SG11674
	call	printf
; Line 10
	lea	rcx, OFFSET FLAT:$SG11675
	call	printf
; Line 11
	lea	rcx, OFFSET FLAT:$SG11676
	call	printf
; Line 12
	lea	rcx, OFFSET FLAT:$SG11677
	call	printf
; Line 13
	lea	rcx, OFFSET FLAT:$SG11678
	call	printf
; Line 14
	lea	rcx, OFFSET FLAT:$SG11679
	call	printf
; Line 15
	lea	rcx, OFFSET FLAT:$SG11680
	call	printf
; Line 16
	lea	rcx, OFFSET FLAT:$SG11681
	call	printf
; Line 17
	lea	rcx, OFFSET FLAT:$SG11682
	call	printf
; Line 18
	lea	rcx, OFFSET FLAT:$SG11683
	call	printf
; Line 19
	lea	rcx, OFFSET FLAT:$SG11684
	call	printf
; Line 20
	lea	rcx, OFFSET FLAT:$SG11685
	call	printf
; Line 21
	lea	rcx, OFFSET FLAT:$SG11686
	call	printf
	npad	1
; Line 22
	add	rsp, 40					; 00000028H
	ret	0
print_menu ENDP
_TEXT	ENDS
; Function compile flags: /Odsp
;	COMDAT printf
_TEXT	SEGMENT
_Result$ = 32
_ArgList$ = 40
_Format$ = 64
printf	PROC						; COMDAT
; File C:\Program Files (x86)\Windows Kits\10\include\10.0.26100.0\ucrt\stdio.h
; Line 956
$LN3:
	mov	QWORD PTR [rsp+8], rcx
	mov	QWORD PTR [rsp+16], rdx
	mov	QWORD PTR [rsp+24], r8
	mov	QWORD PTR [rsp+32], r9
	sub	rsp, 56					; 00000038H
; Line 959
	lea	rax, QWORD PTR _Format$[rsp+8]
	mov	QWORD PTR _ArgList$[rsp], rax
; Line 960
	mov	ecx, 1
	call	__acrt_iob_func
	mov	r9, QWORD PTR _ArgList$[rsp]
	xor	r8d, r8d
	mov	rdx, QWORD PTR _Format$[rsp]
	mov	rcx, rax
	call	_vfprintf_l
	mov	DWORD PTR _Result$[rsp], eax
; Line 961
	mov	QWORD PTR _ArgList$[rsp], 0
; Line 962
	mov	eax, DWORD PTR _Result$[rsp]
; Line 963
	add	rsp, 56					; 00000038H
	ret	0
printf	ENDP
_TEXT	ENDS
; Function compile flags: /Odsp
;	COMDAT _vfprintf_l
_TEXT	SEGMENT
_Stream$ = 64
_Format$ = 72
_Locale$ = 80
_ArgList$ = 88
_vfprintf_l PROC					; COMDAT
; File C:\Program Files (x86)\Windows Kits\10\include\10.0.26100.0\ucrt\stdio.h
; Line 644
$LN3:
	mov	QWORD PTR [rsp+32], r9
	mov	QWORD PTR [rsp+24], r8
	mov	QWORD PTR [rsp+16], rdx
	mov	QWORD PTR [rsp+8], rcx
	sub	rsp, 56					; 00000038H
; Line 645
	call	__local_stdio_printf_options
	mov	rcx, QWORD PTR _ArgList$[rsp]
	mov	QWORD PTR [rsp+32], rcx
	mov	r9, QWORD PTR _Locale$[rsp]
	mov	r8, QWORD PTR _Format$[rsp]
	mov	rdx, QWORD PTR _Stream$[rsp]
	mov	rcx, QWORD PTR [rax]
	call	__stdio_common_vfprintf
; Line 646
	add	rsp, 56					; 00000038H
	ret	0
_vfprintf_l ENDP
_TEXT	ENDS
; Function compile flags: /Odsp
;	COMDAT __local_stdio_printf_options
_TEXT	SEGMENT
__local_stdio_printf_options PROC			; COMDAT
; File C:\Program Files (x86)\Windows Kits\10\include\10.0.26100.0\ucrt\corecrt_stdio_config.h
; Line 92
	lea	rax, OFFSET FLAT:?_OptionsStorage@?1??__local_stdio_printf_options@@9@9 ; `__local_stdio_printf_options'::`2'::_OptionsStorage
; Line 93
	ret	0
__local_stdio_printf_options ENDP
_TEXT	ENDS
END
